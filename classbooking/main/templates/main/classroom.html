{% extends "main/master/index.html" %}
<!---->
{% block title %}
  Classrooms
{% endblock title %}
<!---->
{% block content %}
  <style>
  .progress {
    height: 10px;
  }
  </style>
  <div class="container mt-4">
    <div class="content-card">
      <h2>Classrooms</h2>
      {% if request.user.is_staff %}
        <div class="d-grid mt-4">
          <a href="{% url 'classroom_add' %}" class="btn btn-primary mb-3">Add Classroom</a>
        </div>
      {% endif %}
      {% if classrooms %}
        <div class="row">
          {% for room in classrooms %}
            <div class="col-md-4">
              <div class="content-card">
                <h5>{{ room.name }}</h5>
                <p>
                  Room Number: {{ room.room_number }}
                  <br>
                  Status:
                  {% if room.is_available %}
                    <span class="text-success">Available</span>
                  {% else %}
                    <span class="text-danger">Booked</span>
                  {% endif %}
                  {% if room.booked_by %}
                    <br>
                    Booked by: {{ room.booked_by.username }}
                  {% endif %}
                  <br>
                  Hours Left: {{ room.hours_left }} / {{ room.total_hours }}
                  <br>
                </p>
                <!-- Hours Left Progress Bar -->
                {% load divide %}
                <div class="mb-2">
                  <div class="progress">
                    <div class="progress-bar {% if room.hours_left|divide:room.total_hours > 50 %} bg-success {% elif room.hours_left|divide:room.total_hours > 25 %} bg-warning {% else %} bg-danger {% endif %}"
                         role="progressbar"
                         style="width: {{ room.hours_left|divide:room.total_hours|floatformat:0 }}%"
                         aria-valuenow="{{ room.hours_left }}"
                         aria-valuemin="0"
                         aria-valuemax="{{ room.total_hours }}"></div>
                  </div>
                </div>
                <br>
                {% if request.user.is_staff %}
                  <a href="{% url 'classroom_edit' room.id %}"
                     class="btn btn-sm btn-warning">Edit</a>
                  <a href="{% url 'classroom_remove' room.id %}"
                     class="btn btn-sm btn-danger">Delete</a>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      {% elif not request.user.is_staff %}
        <h5 class="text-muted mt-4">No classroom available.</h5>
      {% endif %}
    </div>
  </div>
{% endblock content %}
